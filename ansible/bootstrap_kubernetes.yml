---

- name: Copy Binaries
  become: true
  ansible.builtin.copy:
    src: downloads/{{ item }}
    dest: /usr/local/bin/{{ item }}
    mode: +x
  with_items:
    - kube-controller-manager
    - kube-scheduler
    - kubectl

- name: Copy service units
  ansible.builtin.copy:
    src: files/units/{{ item }}
    dest: /etc/systemd/system/{{ item }}
  with_items:
    - kube-apiserver.service
    - kube-controller-manager.service
    - kube-scheduler.service

- name: Copy configs
  ansible.builtin.copy:
    src: files/{{ item }}
    dest: /var/lib/kubernetes/{{ item }}
  with_items:
    - kube-api-server.key
    - kube-api-server.crt
    - service-account.key
    - service-account.crt

- name: Copy configs
  ansible.builtin.copy:
    src: files/{{ item }}
    dest: /var/lib/kubernetes/{{ item }}
  with_items:
    - encryption-config.yaml
